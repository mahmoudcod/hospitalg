document.addEventListener('DOMContentLoaded', () => {
  const trackingDataContainer = document.getElementById('trackingDataContainer');
  const searchInput = document.getElementById('searchInput');
  const selectedMonth = document.getElementById('monthSelect');
  const itemsPerPage = 15; // Adjust the number of items per page as needed
  let currentPage = 1;

  const createPatientLink = (data) => {
    const patientLink = document.createElement('h3');
    const patientId = data.id;

    patientLink.textContent = `${data.ticketNumber} - ${data.patientName}`;
    patientLink.id = patientId;
    patientLink.classList.add('patient-link');

    patientLink.addEventListener('click', () => {
      window.location.href = `details2.html#${patientId}`;
    });

    return patientLink;
  };

  const populateMonthSelect = () => {
    const months = [
      'Select Month', 'January', 'February', 'March', 'April',
      'May', 'June', 'July', 'August',
      'September', 'October', 'November', 'December'
    ];

    months.forEach((month, index) => {
      const option = document.createElement('option');
      option.value = month.toLowerCase();
      option.textContent = month;
      selectedMonth.appendChild(option);
    });
  };

  const displayPaginationButtons = (totalPages) => {
    const paginationContainer = document.createElement('div');
    paginationContainer.classList.add('pagination');

    for (let i = 1; i <= totalPages; i++) {
      const button = document.createElement('button');
      button.textContent = i;
      button.addEventListener('click', () => {
        currentPage = i;
        displayTrackingData();
      });
      paginationContainer.appendChild(button);
    }

    trackingDataContainer.appendChild(paginationContainer);
  };

  const displayTrackingData = async () => {
    try {
      const trackingData = await electron.getTrackingData();

      trackingDataContainer.innerHTML = '';

      if (!Array.isArray(trackingData)) {
        trackingDataContainer.innerHTML = '<p>Invalid tracking data format.</p>';
        return;
      }

      if (trackingData.length === 0) {
        trackingDataContainer.innerHTML = '<p>No tracking data available.</p>';
        return;
      }

      const searchTerm = searchInput.value.toLowerCase();
      const selectedMonthValue = selectedMonth.value.toLowerCase();

      // Rest of your existing code for filtering and displaying data
      // ...

    } catch (error) {
      console.error('Error fetching tracking data:', error);
    }
  };

  searchInput.addEventListener('input', () => {
    currentPage = 1; // Reset to the first page when searching
    displayTrackingData();
  });

  selectedMonth.addEventListener('change', () => {
    currentPage = 1; // Reset to the first page when changing the month
    displayTrackingData();
  });

  // Populate the month select dropdown
  populateMonthSelect();

  displayTrackingData();
});
